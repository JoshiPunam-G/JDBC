package com.bridgelabz.batchprocessing;

import java.sql.CallableStatement;
import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.Scanner;

import Utility.ConnectionUtility;

public class BatchUtility {
	static Scanner sc=new Scanner(System.in);
	 static	Connection  connection=ConnectionUtility.getConnection();
	 //******statement Interface************************
		public static void  insertData() throws ClassNotFoundException, SQLException
		{
			String sql ="INSERT INTO studentinfo (id,firstname ,lastname) "
					+"VALUES ( 4, 'vrushali','joshi')";
			
			try
			{
				
				Statement st=connection.createStatement();
				st.addBatch(sql);
				int[] count = st.executeBatch();
	     		System.out.println( count +"Record Inserted Successfully..");
				System.out.println();
				connection.close();
			}catch(Exception e)
			{
				System.out.println(e.getMessage());
			}
		}
		
		/**
		 * update records using statement interface .
		 */
		public  static void Updatetable()
		{
			String sql="UPDATE  studentinfo SET firstname='sarthak' where id=2 ";

			try
			{
				Connection con=getConnection();
				Statement st=con.createStatement();
				int i=st.executeUpdate(sql);
				System.out.println(i  +"Record Updated Successfully..");
				System.out.println();
				con.close();
			}catch(Exception e)
			{
				System.out.println(e.getMessage());
			}
		}
		
		/**
		 * delete record from table using statement interface .
		 */
		public static void Delete()
		{
			String sql="DELETE FROM studentinfo where firstname='punam' ";
			try
			{
				Connection con=getConnection();
				Statement st=con.createStatement();
				int i=st.executeUpdate(sql);
				System.out.println(i  +"Record Deleted Successfully..");
				System.out.println();
				con.close();
			}catch(Exception e)
			{
				System.out.println(e.getMessage());
			}
		}
		


}
